# Solr Standalone Docker Configuration v3.4.0
# Copy this file to .env and customize for your environment

# ============================================================================
# CUSTOMER CONFIGURATION
# ============================================================================
CUSTOMER_NAME=default
MOODLE_DOMAIN=moodle.example.com

# ============================================================================
# SOLR CONFIGURATION
# ============================================================================
SOLR_VERSION=9.9.0
SOLR_PORT=8983
SOLR_BIND_IP=127.0.0.1
SOLR_HEAP_SIZE=2g
SOLR_MEMORY_LIMIT=4g
SOLR_CPU_LIMIT=2.0
SOLR_CPU_RESERVATION=0.5

# ============================================================================
# AUTHENTICATION (Generate secure passwords!)
# ============================================================================
SOLR_ADMIN_USER=admin
SOLR_ADMIN_PASSWORD=changeme_admin_password

SOLR_SUPPORT_USER=support
SOLR_SUPPORT_PASSWORD=changeme_support_password

SOLR_CUSTOMER_USER=customer
SOLR_CUSTOMER_PASSWORD=changeme_customer_password

# ============================================================================
# MOODLE CONFIGURATION
# ============================================================================
MOODLE_VERSION=5.0.x
SOLR_MAX_BOOLEAN_CLAUSES=2048
SOLR_AUTO_COMMIT_TIME=15000
SOLR_AUTO_SOFT_COMMIT_TIME=1000

# ============================================================================
# BACKUP CONFIGURATION
# ============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=7

# ============================================================================
# OPERATION TIMEOUTS (v3.4.0)
# ============================================================================
# Solr startup timeout in seconds (default: 90)
# Increase if you see "Solr did not become ready" errors
SOLR_STARTUP_TIMEOUT=90

# Health check interval in seconds (default: 2)
# How often to check if Solr is ready
SOLR_HEALTH_CHECK_INTERVAL=2

# Progress message interval in seconds (default: 10)
# How often to show "Still waiting..." messages
SOLR_PROGRESS_INTERVAL=10

# Container check timeout in seconds (default: 30)
# How long to wait for container to be in "Up" state
CONTAINER_CHECK_TIMEOUT=30

# Backup lock timeout in seconds (default: 300 = 5min)
# How long to wait if another backup is running
BACKUP_LOCK_TIMEOUT=300

# Transaction lock timeout in seconds (default: 300 = 5min)
# How long to wait for security.json lock during tenant operations
TRANSACTION_LOCK_TIMEOUT=300

# ============================================================================
# LOGGING
# ============================================================================
SOLR_LOG_LEVEL=INFO
# Enable debug mode for scripts (shows detailed execution info)
DEBUG=false

# ============================================================================
# HEALTH API
# ============================================================================
HEALTH_API_PORT=8888

# ============================================================================
# MONITORING CONFIGURATION
# ============================================================================
# Monitoring Mode:
#   none          - No monitoring (production minimal)
#   exporter-only - Only Solr Exporter (for remote Prometheus)
#   full          - Local Prometheus + Grafana + Alertmanager
#
# Usage:
#   none:          docker compose up -d
#   exporter-only: docker compose --profile exporter-only up -d
#   full:          docker compose --profile monitoring up -d
#
MONITORING_MODE=none

# Solr Exporter (for remote monitoring)
EXPORTER_PORT=9854
EXPORTER_BIND_IP=127.0.0.1

# Remote Monitoring (Optional)
# If you have a central Prometheus server, configure here:
# PROMETHEUS_REMOTE_WRITE_URL=https://prometheus.company.com/api/v1/write
# PROMETHEUS_REMOTE_WRITE_USER=
# PROMETHEUS_REMOTE_WRITE_PASSWORD=

# Local Prometheus (Only when MONITORING_MODE=full)
PROMETHEUS_PORT=9090
PROMETHEUS_BIND_IP=127.0.0.1
PROMETHEUS_RETENTION=30d

# Grafana (Only when MONITORING_MODE=full)
GRAFANA_PORT=3000
GRAFANA_BIND_IP=0.0.0.0
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_ROOT_URL=http://localhost:3000
GRAFANA_PLUGINS=

# Alertmanager (Only when MONITORING_MODE=full)
ALERTMANAGER_PORT=9093
ALERTMANAGER_BIND_IP=127.0.0.1

# ============================================================================
# ALERTING CONFIGURATION (Optional)
# ============================================================================
# Enable/Disable specific alert channels
ALERTS_ENABLED=true
SMTP_ENABLED=false
MS_TEAMS_ENABLED=false
WEBHOOK_ENABLED=false

# Email Alerts (Optional - Set SMTP_ENABLED=true)
SMTP_HOST=localhost:25
SMTP_FROM=alertmanager@example.com
SMTP_USER=
SMTP_PASS=
SMTP_TLS=false
ALERT_EMAIL_CRITICAL=admin@example.com
ALERT_EMAIL_WARNING=admin@example.com

# MS Teams Webhook (Optional - Set MS_TEAMS_ENABLED=true)
MS_TEAMS_WEBHOOK_URL=

# Generic Webhook (Optional - Set WEBHOOK_ENABLED=true)
WEBHOOK_URL_CRITICAL=
WEBHOOK_URL_INFO=
